<div style="position: absolute; top: 10px; left: 50px; z-index: 1000; background: rgba(255,255,255,0.8); 
            padding: 5px 10px; border-radius: 5px; font-family: Arial, sans-serif; display: flex; align-items: center;">
    <img src='data:image/png;base64,{image_logo_kpc}' style='height:30px; margin-right: 5px; object-fit: contain;'>
    <img src='data:image/png;base64,{image_logo_pama}' style='height:30px; margin-right: 10px; object-fit: contain;'>
    <strong style='font-size:14px; font-weight:800; color:#333; white-space:nowrap;'>PAMA - KPCS - BOT MIO SPEED {region}</strong>
</div>
<div style="position:absolute; top:60px; left:50px; z-index:1000; background:rgba(255,255,255,0.8); 
            padding:5px 10px; border-radius:5px; font-family:Arial, sans-serif; line-height:1.6;">
    <b>Speed Legend</b><br>
    <span style='color:blue;'>●</span> 0 kph (zero speed)<br>
    <span style='color:red;'>●</span> &lt; 18 kph<br>
    <span style='color:yellow;'>●</span> 18–20 kph<br>
    <span style='color:green;'>●</span> 20–25 kph<br>
    <span style='color:black;'>●</span> ≥ 30 kph
</div>
<div style="position: absolute;right: 5px; width: 20vw; height: 100%;
            z-index: 1000; background-color: rgba(255, 255, 255, 0.9); 
            padding: 10px; font-family: Arial, sans-serif; font-size: 12px; 
            color: #333; box-shadow: 0 2px 10px rgba(0,0,0,0.3); 
            line-height: 1.3; display: flex; flex-direction: column; 
            gap: 5px; border: 1px solid #bbb; border-radius: 8px; 
            backdrop-filter: blur(3px); overflow-y: auto;">
    
    <div style="font-weight: bold; margin-bottom: 5px; text-align: center; 
                border-bottom: 2px solid #3498db; padding-bottom: 0px; background: #fff; border-radius: 8px 8px 0 0; letter-spacing: 0.5px; font-size: 13px; color: #2266a3; box-shadow: 0 2px 8px rgba(52,152,219,0.04); border: 1px solid #e5e7eb;">
        <span style="font-size: 12px; font-weight: 700; color: #344966; letter-spacing: 0.5px;">Created at :</span>
        <span style="font-size: 12px; font-weight: 500; color: #444; margin-left: 6px;">{created_at}</span>
    </div>
    <div style="font-weight: bold; margin-bottom: 8px; text-align: center; border-bottom: 2px solid #3498db; padding-bottom: 7px; background: #fff; border-radius: 0 0 8px 8px; letter-spacing: 0.5px; font-size: 15px; color: #2266a3; box-shadow: 0 2px 8px rgba(52,152,219,0.04); border: 1px solid #e5e7eb; border-top: none;">
        <span style="font-size: 14px; font-weight: 800; color: #344966; letter-spacing: 1px;">ROAD PERFORMANCE</span><br>
        <span style="font-size: 12px; font-weight: 500; color: #444; margin-left: 8px;">({dottrace_duration_hours} jam terakhir)</span>
    </div>

    <div style="display:flex;gap:12px;margin-top:0px;font-family:'Segoe UI',Tahoma,sans-serif;align-items:stretch;">
        <!-- Main metric card (dark gray) -->
        <div style="flex:1;min-width:100px;max-width:260px;">
            <div style="background:#{card_color};color:#fff;border-radius:12px;padding:18px 10px;box-shadow:0 6px 18px rgba(15,23,42,0.12);display:flex;flex-direction:column;align-items:center;justify-content:center;">
                <div style="font-size:11px;font-weight:700;color:#ffffff;letter-spacing:0.6px;text-transform:uppercase;margin-bottom:10px;">Average road speed</div>
                <div style="font-size:40px;font-weight:800;line-height:1;color:#ffffff;">{average_speed}</div>
                <div style="font-size:13px;color:#ffffff;margin-top:6px;">kph</div>
            </div>
        </div>

        <!-- Two stacked accent metric cards -->
        <div style="display:flex;flex-direction:column;gap:8px;min-width:100px;max-width:220px;">
            <div style="background:#ffffff;border-radius:12px;padding:12px 12px;box-shadow:0 6px 18px rgba(15,23,42,0.06);display:flex;align-items:center;gap:12px;border-left:6px solid #06b6d4;">
                <div style="flex:1;">
                    <div style="font-size:11px;font-weight:700;color:#374151;text-transform:uppercase;">Loaded speed</div>
                    <div style="font-size:20px;font-weight:800;color:#111827;">{loaded_speed} <span style="font-size:12px;color:#6b7280;">kph</span></div>
                </div>
            </div>

            <div style="background:#ffffff;border-radius:12px;padding:12px 12px;box-shadow:0 6px 18px rgba(15,23,42,0.06);display:flex;align-items:center;gap:12px;border-left:6px solid #7c3aed;">
                <div style="flex:1;">
                    <div style="font-size:11px;font-weight:700;color:#374151;text-transform:uppercase;">Empty speed</div>
                    <div style="font-size:20px;font-weight:800;color:#111827;">{empty_speed} <span style="font-size:12px;color:#6b7280;">kph</span></div>
                </div>
            </div>
        </div>
    </div>
    
    <div style="display:flex;gap:8px;font-family:'Segoe UI',Tahoma,sans-serif;">
        <!-- Stat card: Jumlah DT -->
        <div style="flex:1;display:flex;align-items:center;background:#ffffff;border-radius:12px;padding:5px 5px;box-shadow:0 6px 18px rgba(15,23,42,0.06);border:1px solid #eef2f7;">
            <div style="border-radius:12px;background:linear-gradient(180deg,#eef2ff,#e6f6ff);display:flex;align-items:center;justify-content:center;">
            <div>
                <div style="font-size:10;font-weight:700;color:#374151;">Jumlah DT</div>
                <div style="font-size:15px;font-weight:800;color:#111827;">{total_dt} Unit</div></div>
            </div>
        </div>


        <!-- Stat card: Total Frekuensi -->
        <div style="flex:1;display:flex;align-items:center;background:#ffffff;border-radius:12px;padding:5px 5px;box-shadow:0 6px 18px rgba(15,23,42,0.06);border:1px solid #eef2f7;">
            <div style="border-radius:12px;background:linear-gradient(180deg,#fff7ed,#fff2e6);display:flex;align-items:center;justify-content:center;">
            <div>
                <div style="font-size:10;font-weight:700;color:#374151;">Speed &lt; 18 kph</div>
                <div style="font-size:15px;font-weight:800;color:#111827;">{percentage_slow}%</div></div>
            </div>
        </div>
    </div>

    <div style="font-weight: bold; margin-top: 5px; text-align: center; border-bottom: 1px solid #3498db; background: #fff; border-radius: 0 0 8px 8px; letter-spacing: 0.5px; font-size: 15px; color: #2266a3; box-shadow: 0 2px 8px rgba(52,152,219,0.04); border: 1px solid #e5e7eb; border-top: none;">
        <span style="font-size: 13px; font-weight: 800; color: #344966; letter-spacing: 1px;">Top 5 Lokasi Perlambatan:</span><br>
    </div>

    <table style="width:100%;border-collapse:collapse;font-size:0.8em;font-family:sans-serif;min-width:130px;box-shadow:0 0 20px rgba(0,0,0,0.15);border-radius:8px;overflow:hidden;border:1px solid #e6eef0;">
        <thead>
            <tr style="background-color:#009879;color:#ffffff;text-align:left;">
                <th style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">Lokasi</th>
                <th style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">Speed</th>
                <th style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">Grade</th>
            </tr>
        </thead>
        <tbody>
            <tr style="border-bottom:1px solid #dddddd;">
                <td style="padding:8px 2px;border:1px solid #dddddd;">{loc1}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{count1}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{grade1}</td>
            </tr>
            <tr style="background-color:#f3f3f3;border-bottom:1px solid #dddddd;">
                <td style="padding:8px 2px;border:1px solid #dddddd;">{loc2}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{count2}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{grade2}</td>
            </tr>
            <tr style="border-bottom:1px solid #dddddd;">
                <td style="padding:8px 2px;border:1px solid #dddddd;">{loc3}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{count3}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{grade3}</td>
            </tr>
            <tr style="background-color:#f3f3f3;border-bottom:1px solid #dddddd;">
                <td style="padding:8px 2px;border:1px solid #dddddd;">{loc4}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{count4}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{grade4}</td>
            </tr>
            <tr style="border-bottom:2px solid #009879;">
                <td style="padding:8px 2px;border:1px solid #dddddd;">{loc5}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{count5}</td>
                <td style="padding:8px 2px;border:1px solid #dddddd;text-align:center;">{grade5}</td>
            </tr>
        </tbody>
    </table>
    
    <div style="font-weight: bold; margin-top: 5px; text-align: center; border-bottom: 1px solid #3498db; background: #fff; border-radius: 0 0 8px 8px; letter-spacing: 0.5px; font-size: 15px; color: #2266a3; box-shadow: 0 2px 8px rgba(52,152,219,0.04); border: 1px solid #e5e7eb; border-top: none;">
        <span style="font-size: 13px; font-weight: 800; color: #344966; letter-spacing: 1px;">Bottom 3 Speed Operator:</span><br>
    </div>
    <div style="margin-top: 10px; text-align: center;">
        <img src="{underspeed_chart}" style="width: 100%; height: auto; display: block; margin: auto;">
    </div>
</div>
